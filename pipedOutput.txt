





------- Bank Hapoalim Exercise Output -------
--- Ex. 2a. distinct values in credit_history column 
+--------------------+
|      credit_history|
+--------------------+
|            all paid|
| no credits/all paid|
|critical/other ex...|
|  delayed previously|
|       existing paid|
+--------------------+

--- Ex. 2b. credit request >10,000 by unemployed male at least 30 y.o.
--> only displaying purpose column for brevity
+-------+
|purpose|
+-------+
|new car|
|  other|
+-------+

--- Ex. 2c. Average requested amount grouped by purpose, descending
+-------------------+------+
|            purpose|AvgAmt|
+-------------------+------+
|              other|8209.0|
|           used car|5370.0|
|           business|4158.0|
|          education|3180.0|
|furniture/equipment|3067.0|
|            new car|3063.0|
|            repairs|2728.0|
|           radio/tv|2488.0|
| domestic appliance|1498.0|
|         retraining|1206.0|
+-------------------+------+

--- Ex. 2d. BONUS - Number of customers employed over 4 yrs.
+-------------+
|Distinguished|
+-------------+
|          427|
+-------------+

--- Ex. 3 Predictive Model Classifying Customer as a Good or Bad credit risk
Index the categorical columns to numeric representation using StringIndexer ...

+-----------------------------------+
|num_feat                           |
+-----------------------------------+
|[6.0,1169.0,4.0,4.0,67.0,2.0,1.0]  |
|[48.0,5951.0,2.0,2.0,22.0,1.0,1.0] |
|[12.0,2096.0,2.0,3.0,49.0,1.0,2.0] |
|[42.0,7882.0,2.0,4.0,45.0,1.0,2.0] |
|[24.0,4870.0,3.0,4.0,53.0,2.0,2.0] |
|[36.0,9055.0,2.0,4.0,35.0,1.0,2.0] |
|[24.0,2835.0,3.0,4.0,53.0,1.0,1.0] |
|[36.0,6948.0,2.0,2.0,35.0,1.0,1.0] |
|[12.0,3059.0,2.0,4.0,61.0,1.0,1.0] |
|[30.0,5234.0,4.0,2.0,28.0,2.0,1.0] |
|[12.0,1295.0,3.0,1.0,25.0,1.0,1.0] |
|[48.0,4308.0,3.0,4.0,24.0,1.0,1.0] |
|[12.0,1567.0,1.0,1.0,22.0,1.0,1.0] |
|[24.0,1199.0,4.0,4.0,60.0,2.0,1.0] |
|[15.0,1403.0,2.0,4.0,28.0,1.0,1.0] |
|[24.0,1282.0,4.0,2.0,32.0,1.0,1.0] |
|[24.0,2424.0,4.0,4.0,53.0,2.0,1.0] |
|[30.0,8072.0,2.0,3.0,25.0,3.0,1.0] |
|[24.0,12579.0,4.0,2.0,44.0,1.0,1.0]|
|[24.0,3430.0,3.0,2.0,31.0,1.0,2.0] |
+-----------------------------------+
only showing top 20 rows

+-------------------------------------------------------------+
|cat_feat                                                     |
+-------------------------------------------------------------+
|(15,[0,1,5,6,9,10,12,13],[2.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0])  |
|(15,[0,1,8,10,12],[1.0,1.0,1.0,2.0,1.0])                     |
|(15,[0,1,2,6,11,12,13],[1.0,2.0,1.0,2.0,5.0,1.0,1.0])        |
|(15,[0,1,6,7,10,11,12,14],[1.0,2.0,2.0,2.0,1.0,2.0,2.0,1.0]) |
|(15,[0,1,7,10,11,12,13],[2.0,2.0,2.0,1.0,1.0,3.0,2.0])       |
|(15,[0,1,2,5,7,9,11,12],[1.0,2.0,1.0,1.0,2.0,1.0,5.0,3.0])   |
|(15,[0,1,5,6,11,12],[1.0,1.0,3.0,1.0,2.0,2.0])               |
|(15,[0,1,2,7,9,10,11],[1.0,1.0,2.0,1.0,1.0,2.0,3.0])         |
|(15,[0,1,2,5,6,8,12],[1.0,1.0,1.0,4.0,2.0,3.0,1.0])          |
|(15,[0,1,2,6,8,10,11,13],[2.0,1.0,2.0,4.0,2.0,2.0,1.0,1.0])  |
|(15,[0,1,6,7,8,10,11],[1.0,1.0,3.0,1.0,1.0,2.0,1.0])         |
|(15,[0,1,6,7,8,10,11,12],[1.0,1.0,3.0,1.0,1.0,1.0,4.0,2.0])  |
|(15,[0,1,8,9,10],[1.0,1.0,1.0,1.0,2.0])                      |
|(15,[0,1,2,6,10,11,13],[2.0,1.0,1.0,1.0,1.0,1.0,1.0])        |
|(15,[0,1,7,8,10,11],[1.0,1.0,1.0,1.0,1.0,1.0])               |
|(15,[0,1,2,5,8,10],[1.0,1.0,1.0,2.0,1.0,1.0])                |
|(15,[0,1,5,6,12,13],[2.0,1.0,1.0,1.0,2.0,1.0])               |
|(15,[0,1,4,5,6,10,11,13],[3.0,1.0,1.0,1.0,3.0,1.0,4.0,4.0])  |
|[1.0,1.0,2.0,0.0,0.0,0.0,1.0,2.0,1.0,1.0,2.0,3.0,3.0,0.0,0.0]|
|(15,[0,1,5,6,9],[1.0,2.0,3.0,1.0,1.0])                       |
+-------------------------------------------------------------+
only showing top 20 rows

